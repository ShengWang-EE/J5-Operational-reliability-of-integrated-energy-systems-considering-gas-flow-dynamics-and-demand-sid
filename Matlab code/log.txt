20190922
linepackForTrans的公式应该不对
20190923
天然气opf不收敛
好像是电力系统负荷的锅？
经过仿真，linepack大小的确会改变OR能力.
20190926
Gsou的初值，以及上下界的确定选取很重要，不然不能收敛
20200514
MP问题不收敛，还是动态约束的问题.大于小于都行，就是等于不行
20200524
动态方程，初始部位0，后来都是0，不科学
sum(nx)=135，也就是从第二个时间开始不等于0
优化前3*10e7 -> 310,都是从fmotion里来的
!!!!找到问题了，是Q的单位
但还是不收敛
20200531
SP的对偶问题不可行.
原来是si没约束单独的下限，只约束了几个si求和后的下限
20200601
MP还是有问题。gi不为0，因为dynamics的缘故
要把小时对应上

gasflow cell里面的数值有突变，检查一下:
(1)算basicload的时候括号加错地方

20200602
或者考虑二次规划？
20200603
SP返回的约束只对几个时时间段进行了约束？
20200611
SCOP只要右端是常数，最小可以到1左右，但是不能是0。这已经足够了。所以右端写成常数+slack的形式就行，算的就挺快

20200615
从占地面积来看rts24占地240*160km2，和比利时国土差不多大。但是要考虑负荷密度的问题。
从英国来看，全英国gas供给459Mm3/day，电力60GW
Shahidehpour文章，天然气18.1，发电10左右
如果取gaslib的数据，40bus为52.2，24bus为13，那和2.8，11bus为7.2

20200615
调整reserve需求量，让能进入shifting

20190618
shiftin 限制了shiftout.
或者程序就没错，因为benders限制了ei刚刚能满足正常负荷，不能满足移入的，所以要再迭代

20200629
为啥LB，UB不单调？
应该LB肯定会上升，UB由于ei，gi越给越多，EH的成本也会下降，所以应该会变小

20200708
对SP问题逐步调试。有以下两个问题：
首先在MP的气压约束最轻松的时候，在iter= 71 的时候relaxed SP feasible，但是不能仅靠能源替代SP，但是也没添加LPcut？
-忘把test beta=1去掉了
-relax和bigM有冲突。因为relax之后sw可以是一个很小的数，但是和bigM相乘之后变成正常大小
-add LPcut 有问题，都是一样的cut
经过这个sp后，mp的求解时间大幅上升？

20200710
假设不把上层变量算进来，在LP generating中

% 20200711
LP 搞不定。换回原来的sp，那就reserve太少，不能shift
20200712
mp的计算时间还是可能很长。
addcut第二次迭代的第一个约束和第一次的怎么不一样

还是有不能shiftin的现象
而且LB为啥也是下降的？
-是不是EHcost_hat没有包括历史迭代的数据导致的？

20200715
改了addcut的计算方式后好了，放宽nonDR的ei范围，能有shifting
现在考虑不妨宽ei能不能有shifting
很奇怪，放款有shifting，但是一旦收紧就gurobi outof memory
为啥只shift electricity
--因为cooling由EHP提供的容量基本满了，剩下的都是由gas提供的，shifting了对削减电力负荷没帮助
电力shift只需要支付shift的成本。cooling shift，假设从EHPshift到有容量的AB，那不仅支付shift成本，还要支付多出来的天然气成本
通过验证，当heating和cooling的转移成本和电相同的时候，只有电转移。0.1倍的时候，只有冷热转移。0.3倍的时候，都有转移\

20200719
case中出现电力负荷谷向峰转移的情况，应该是负荷曲线和DR时段配合不行的缘故。需要换电力负荷曲线
还有so只有对应一个si的情况。是不是so和si约束的时候写错了？

20200724
电力备用不能削的太多。太多了之后，因为热负荷少，chp发电少，只能通过减少EHP，而AB容量小，EH不能减小太多
20200725
收敛慢，改回原来的cut generating方式
20200729
就是负荷的原因，负荷一换回来就快速收敛

20200903
！！ EHschedule 和SP里面的CHP约束写错了

20200907
在目标函数里加上prs偏差的cost。当不增加的时候prs在gi增加时变化不明显
*10的时候prs变得很直，感觉不大对，但是没有触及上下限

20210302
有几个问题：
1.故障概率太小，对优化调度结果影响不大。
2.通过向前看和不向前看的调度，只能在经济性和可靠性之间置换。
3.如何在电力和天然气系统可靠性之间置换？调节电和气的CDF？
更好的是比较气网开放多少管存给电，即有电力切负荷的时候，燃气机组和EH会更加消耗天然气，天然气气压波动能放开多少？
开放多了，管存不足，导致气网（未来还是整体？应该可以是整体）可靠性下降。（识别故障模式然后调节Prsmin和Prsmax）这样可以解决2，3问题
那有气网故障的时候是不是无限放开，只有电网故障的时候设置比例？
这个其实和向不向前看差不多

20210304
为啥降不下来燃气机组发电量？
通过减少GFU容量，总成本的确下降了。为啥GFU不会自己减少发电量？
缩小可行域，目标函数反而更小了。要不是可行域定义有问题，要不是算法有问题（自己写的导数部分）
20210305
gas motion equation原来soc是小于等于现在改成等于
故障场景infeasible，正常场景可以。为啥?（即使气压放开）
也不是全部故障场景都不可以。比如那个最大气源就不能故障
原来是Pgmin的缘故。。。没有设成0
但是气压太小还是会infeasible
20210305
原来天然气动态线性化用的平均值差一点也会直接导致不收敛
正常case已经能收敛了,如果terminalcondition比较紧那收敛慢一点
但是会振荡，可以稍微加点启停成本意思一下
20210308
第二次求解的时候，即使约束较小也是可行的（obj=【】）可是为啥也求不出来
20210312
几种负荷方式下的可靠性求解
1.主网和EH负荷全固定：非常震荡，因为全都是气网优化控制导致的
2.EH变动，主网固定。呈现中后方高，两边低，还看得过去，但是一个变动一个不变动说不过去
3.都变动，负荷太小，仿真10000次后电力和天然气都没切负荷
感觉还是都变动合理，但是得扩大负荷
经过实验，扩大了之后（峰值为正常负荷），只有在坏4/5个气源1时有切少量气，切电倒是比较正常
天然气故障率扩大到原来10倍
可以求出来了，但还是振荡。再扩大爬坡成本试试
天然气爬坡扩大，天然气CDF增加后电力的切负荷增加。看看这是爬坡引起的还是cdf引起的（6，0.0025）对比（0.95，0.0047）
单单增加天然气爬坡时（2.4，0.009）
最后决定还是按照正常来，天然气不增加爬坡成本，最后可靠性指标匀一下